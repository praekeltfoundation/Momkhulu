{% extends "base.html" %}

{% block content %}
<div class="patient-board">
  <a href="{% url 'cspatient_view' %}" class="call-to-action__nav call-to-action__nav--back">Back to the triage board</a>
  <h2 class="heading heading__hero">Patient Details</h2>
  {% if patiententry %}
    <div class="patient-board--wrapper">
      <div class="patient-board__personal">
        <ul class="list-group">
          <li class="list-group-item py-2">
            <h4>Personal Details</h4>
          </li>
          <li class="list-group-item py-2">
            SURNAME <br/>
            <div>{{ patiententry.patient.name }}</div>
          </li>
          <li class="list-group-item py-2">
            PATIENT ID <br/>
            <div>{{ patiententry.patient.patient_id }}</div>
          </li>
          <li class="list-group-item py-2">
            AGE <br/>
            <div>{{ patiententry.patient.age }}</div>
          </li>
          <li class="list-group-item py-2">
            GRAVPAR <br/>
            <div>{{ patiententry.gravpar|default_if_none:"-" }}</div>
          </li>
          <li class="list-group-item py-2">
            ADDITIONAL INFORMATION <br/>
            <div>{{ patiententry.outstanding_data|default_if_none:"-" }}</div>
          </li>
        </ul>
      </div>
      <div class="patient-board__surgery">
        <ul class="list-group">
            <li class="list-group-item py-2">
                <h4>Surgery Details</h4>
            </li>
            <li class="list-group-item py-2">
                <div style="float: left">
                    OPERATION <br/>
                    <div>{{ patiententry.operation }}</div>
                </div>
                {% if patiententry.completion_time %}
                    <div class="urgency urgency-0" style="padding: 6px;text-align: center;width: 200px; float: right">COMPLETE</div>
                {% else %}
                    <div class="urgency urgency-{{ patiententry.urgency }}" style="padding: 6px;text-align: center;width: 200px; float: right">{{patiententry.get_urgency_display}}</div>
                {% endif %}
            </li>
            <li class="list-group-item py-2">
                LOCATION <br/>
                <div>{{ patiententry.location|default_if_none:"-" }}</div>
            </li>
            <li class="list-group-item py-2">
                INDICATION <br/>
                <div>{{ patiententry.indication|default_if_none:"-" }}</div>
            </li>
            <li class="list-group-item py-2">
                CLINICIAN <br/>
                <div>{{ patiententry.clinician|default_if_none:"-" }}</div>
            </li>
            <li class="list-group-item py-2">
                <div style="width: 50%;float: left;">
                    DECISION TIME <br/>
                    <div>{{ patiententry.decision_time|date:"Y-m-d H:i" }}</div>
                </div>
                <div style="width: 50%;float: left;">
                    TIME OUT OF THEATRE <br/>
                    <div>{{ patiententry.completion_time|date:"Y-m-d H:i" }}</div>
                </div>
            </li>
            <li class="list-group-item py-2">
                <div style="width: 50%;float: left;">
                    DATE OF DELIVERY <br/>
                    <div>
                      {% for baby in patiententry.entry_babies.all|slice:":1" %}
                        {{ baby.delivery_time|date:"Y-m-d" }}
                      {% endfor %}
                    </div>
                </div>
                <div style="width: 50%;float: left;">
                    NUMBER OF BABIES <br/>
                    <div>{{ patiententry.foetus|default_if_none:"-" }}</div>
                </div>
            </li>
        </ul>
      </div>
  </div>

    <div style="width: 100%; float: left;padding: 20px;">
        {% for baby in patiententry.entry_babies.all %}
            <ul class="list-group">
                <li class="list-group-item py-2">
                    <h5>Delivery Details: Baby {{ baby.baby_number }}</h5>
                </li>
                <li class="list-group-item py-2">
                    TIME OF DELIVERY <br/>
                    <div>{{ baby.delivery_time|time:"H:i" }}</div>
                </li>
                <li class="list-group-item py-2">
                    WEIGHT OF BABY <br/>
                    <div>{{ baby.baby_weight_grams }}</div>
                </li>
                <li class="list-group-item py-2">
                    APGAR 1 <br/>
                    <div>{{ baby.apgar_1 }}</div>
                </li>
                <li class="list-group-item py-2">
                    APGAR 5 <br/>
                    <div>{{ baby.apgar_5 }}</div>
                </li>
                <li class="list-group-item py-2">
                    NICU <br/>
                    <div>{{ baby.nicu }}</div>
                </li>
            </ul>
            {% endfor %}
        </div>
    </div>
{% else %}
    <div style="text-align: center;width: 100%;">
        <p>Sorry. No such patient was found.</p>
    </div>
{% endif %}
</div>

{% endblock %}
