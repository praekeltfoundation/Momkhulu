{% extends "base.html" %}

{% block content %}
<div class="patient-board">
  <a href="{% url 'cspatient_view' %}" class="call-to-action__nav call-to-action__nav--back">Back to the triage board</a>
  <h2 class="heading heading__hero">Patient Details</h2>
  <div class="patient-nav">
    <p class="heading heading__label">View</p>
    <ul class="patient-nav-list">

      <li class="patient-nav-list__item"><a href="#patient_personal_details">Personal Details</a></li>
      <li class="patient-nav-list__item"><a href="#patient_surgery_details">Surgery Details</a></li>
      <li class="patient-nav-list__item"><a href="#patient_delivery_details">Delivery Details</a></li>
    </ul>
  </div>
  {% if patiententry %}
    <div class="patient-board--wrapper">
      <div id="patient_personal_details" class="patient-board__personal">
        <h4 class="heading heading__title">Personal Details</h4>
        <ul class="patient-list">
          <li class="patient-list__item">
            <h5 class="patient-list__label">Surname</h5>
            <h4 class="patient-list__entry">{{ patiententry.patient.name }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Patient ID</h5>
            <h4 class="patient-list__entry">{{ patiententry.patient.patient_id }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Age</h5>
            <h4 class="patient-list__entry">{{ patiententry.patient.age }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Gravpar</h5>
            <h4 class="patient-list__entry">{{ patiententry.gravpar|default_if_none:"-" }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Additional information</h5>
            <h4 class="patient-list__entry">{{ patiententry.outstanding_data|default_if_none:"-" }}</h4>
          </li>
        </ul>
      </div>
      <div id="patient_surgery_details" class="patient-board__surgery">
        <h4 class="heading heading__title">Surgery Details</h4>
        <ul class="patient-list">
          <li class="patient-list__item">
            <h5 class="patient-list__label">Operation</h5>
            <h4 class="patient-list__entry">{{ patiententry.operation }}</h4>
            {% if patiententry.completion_time %}
              <h4 class="patient-list__entry urgency urgency-0">Complete</h4>
            {% else %}
              <h4 class="patient-list__entry urgency urgency-{{ patiententry.urgency }}">
                {{patiententry.get_urgency_display}}
              </h4>
            {% endif %}
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Location</h5>
            <h4 class="patient-list__entry">{{ patiententry.location|default_if_none:"-" }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Indication</h5>
            <h4 class="patient-list__entry">{{ patiententry.indication|default_if_none:"-" }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Clinician</h5>
            <h4 class="patient-list__entry">{{ patiententry.clinician|default_if_none:"-" }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Decision time</h5>
            <h4 class="patient-list__entry">{{ patiententry.decision_time|date:"Y-m-d H:i" }}</h4>

            <h5 class="patient-list__label">Time out of theatre</h5>
            <h4 class="patient-list__entry">{{ patiententry.completion_time|date:"Y-m-d H:i" }}</h4>
          </li>
          <li class="patient-list__item">
            <h5 class="patient-list__label">Date of delivery</h5>
            <h4 class="patient-list__entry">
              {% for baby in patiententry.entry_babies.all|slice:":1" %}
                <span>{{ baby.delivery_time|date:"Y-m-d" }}</span>
              {% endfor %}
            </h4>

            <h5 class="patient-list__label">Number of babies</h5>
            <h4 class="patient-list__entry">{{ patiententry.foetus|default_if_none:"-" }}</h4>
          </li>
        </ul>
      </div>
    </div>
    <div id="patient_delivery_details" class="patient-board__delivery">
      {% for baby in patiententry.entry_babies.all %}
      <div class="patient-board__delivery-list">
        <ul class="patient-list">
            <li class="patient-list__item">
              <h5>Delivery Details: Baby {{ baby.baby_number }}</h5>
            </li>
            <li class="patient-list__item">
                <h5 class="patient-list__label">TIME OF DELIVERY</h5>
                <h4 class="patient-list__entry">{{ baby.delivery_time|time:"H:i" }}</h4>
            </li>
            <li class="patient-list__item">
                <h5 class="patient-list__label">WEIGHT OF BABY</h5>
                <h4 class="patient-list__entry">{{ baby.baby_weight_grams }}</h4>
            </li>
            <li class="patient-list__item">
                <h5 class="patient-list__label">APGAR 1</h5>
                <h4 class="patient-list__entry">{{ baby.apgar_1 }}</h4>
            </li>
            <li class="patient-list__item">
                <h5 class="patient-list__label">APGAR 5</h5>
                <h4 class="patient-list__entry">{{ baby.apgar_5 }}</h4>
            </li>
            <li class="patient-list__item">
                <h5 class="patient-list__label">NICU</h5>
                <h4 class="patient-list__entry">{{ baby.nicu }}</h4>
            </li>
        </ul>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div style="patient-board__no-results">
      <h4 class="heading heading__title">Sorry. No such patient was found.</h4>
    </div>
  {% endif %}
</div>
{% endblock %}
